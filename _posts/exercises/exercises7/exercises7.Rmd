---
title: "Exercises 7"
description: |
  Instrumental Variables
author:
  - name: Ralf Martin
    url: https://mondpanther.github.io/wwwmondpanther/
date: "`r Sys.Date()`"
output:
  distill::distill_article:
    self_contained: true
    css: ../../webex.css
    includes:
      after_body: ../../webex.js
categories:
  - Exercises
editor_options: 
  chunk_output_type: inline
---








```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
if (!requireNamespace("webex")) {
  stop("You must have the 'webex' package installed to knit HTML from this template.\n   devtools::install_github(\"psyteachr/webex\")")
} else {
  library("webex")
}
library(car)
library(plm)
library(AER)
library(ivpack)
library(ggplot2)
```




# Exercise 7.1

Use the dataset4.dta dataset. It contains weekly prices for rail transport of grain in the US midwest during the 1880s, and the quantity shipped. The railroad companies at the time operated a cartel, called the Joint Executive Committee (JEC), which is believed to have raised prices above the level that would have otherwise prevailed. This practice was legal before the Sherman Act of 1890 (antitrust legislation) was passed. From time to time, cheating by cartel members brought about a temporary collapse of the collusive price setting agreement. A dummy variable – “cartel”- in the data set indicates the period when price fixing was in effect. 

```{r }
library(haven)
d4=read_dta("https://www.dropbox.com/sh/rqmo1hvij1veff0/AABQXwWvdZdvGlT6Y8LIfoMha/dataset4.dta?dl=1")
names(d4)
```

### Part (a)

Run an OLS regression of the log quantity on the log price, controlling for ice, indicating that the Great Lakes were frozen preventing transport by ship, and a set of seasonal dummy variables (to capture seasonality in demand; note that dataset has 12 seasonal dummies; i.e. they tread every month as a season). 

What is the estimated price elasticity? `r fitb(-0.64)`

Do you think you are estimating a demand curve? Explain. `r mcq(c("No", answer = "Yes"))`

Think of what the the economic rationale is of including the variable “ice” in the regression?

`r hide("Answer:")`

```{r }
m1=lm(log(quantity)~log(price)+ice+seas1+seas2+seas3+seas4+seas5+seas6+seas7+seas8+seas9+seas10+seas11+seas12, data=d4)
coeftest(m1, vcov=vcovHC)
```

The regression implies a price elasticity of -0.64; i.e. a 1% increase in price will lead to a 0.64% reduction in demand.
We can interpret this as a demand curve, if the price coefficient really represents the effect of a price change on demand holding all other things constant. 
One reason why this might not be the case is if shocks to demand cause price changes. On the other hand if we can control for big potential shocks to demand it will be possible to recover un-biased estimates. A big potential demand shock here is the freezing of the lakes: Because rail transport becomes the only option and hence demand increases it might lead to price changes. Indeed we see that “ice” has a significant positive effect on demand.


`r unhide()`

### Part (b)

Consider using cartel as an instrument for price in order to identify the demand curve. 

Is the instrument is likely to satisfy the conditions for a valid instrument? `r mcq(c("No", answer = "Yes"))`

Can you use the data to check these conditions? `r mcq(c("No", "Yes", answer = "Somewhat"))`

`r hide("Answer:")`

Exogenous? Having a cartel is clearly a supply side factor that will by and large depend on the number of firms in the market and their respective manager to strike a deal, all factors un-related to demand.  However, the incentive to form a cartel is also driven the amount of money to be made from having a cartel which is a demand side factor. Having said that, it is more likely that long term structural aspects of of demand are relevant for this rather than the weekly changes over a relatively short time period (6 years). Hence, it is plausible that we can use cartel as an IV.

Driving explanatory variable? It is almost the definition of a cartel that it has a positive impact on price. At any rate this is something we can check via a first stage regression.

Exclusion? It is fairly plausible that the main effect of cartel on demand is via price. However, we can also imagine scenarios where the exclusion restriction might not hold in such a setting: imagine that the mere fact that the industry forms a cartel leads to some kind of negative press and consumer backlash perhaps with a boycott. Having said that, this is probably more of a concern with consumer goods rather than railway cargo transport.

Note: What I discussed here is not the only possible way to answer this. In particular how to answer requirements 1 and 3 is somewhat down to subjective judgement. As long as students make a good case and mention and discuss all relevant requirements it’s ok to get full points.

`r unhide()`

### Part (c)

Estimate the first stage and reduced form equations. 

What is the effect of cartel on price in the first stage?  `r mcq(c("Not significant", answer = "Significant"))`

What is the effect of cartel on price in the reduced form?   `r mcq(c("Positive", answer = "Negative"))`

`r hide("Answer:")`

First stage suggests highly significant effect of cartel on price.

```{r }
fs=lm(log(price)~cartel+ice+seas1+seas2+seas3+seas4+seas5+seas6+seas7+seas8+seas9+seas10+seas11+seas12, data=d4)
coeftest(fs,vcov=vcovHC)
linearHypothesis(fs,"cartel=0")
```

Reduced form shows strong negative effect of cartel on price as would be expected.

```{r }
rf=lm(log(quantity)~cartel+ice+seas1+seas2+seas3+seas4+seas5+seas6+seas7+seas8+seas9+seas10+seas11+seas12, data=d4)
coeftest(rf,vcov=vcovHC)
```


`r unhide()`

### Part (d)

Estimate the demand function by IV. What is your estimated demand elasiticity?  `r fitb(-0.86)`

How does it differ from your OLS estimate in (a)? `r mcq(c("More positive", answer = "More negative"))`

`r hide("Answer:")`

IV regression suggests a price elasticity of -0.86; i.e. the estimate has become stronger (more elastic; i.e. more negative) compared to OLS. This is consistent with positive demand shocks in exerting a positive influence on price (i.e. the OLS estimate would be biased upward so that it becomes less negative than is true in reality)

```{r }
library(AER)
iv=ivreg(log(quantity)~log(price)+ice+seas1+seas2+seas3+seas4+seas5+seas6+seas7+seas8+seas9+seas10+seas11+seas12| cartel+ice+seas1+seas2+seas3+seas4+seas5+seas6+seas7+seas8+seas9+seas10+seas11+seas12, data=d4)
robust.se(iv)
```

`r unhide()`

### Part (e)

Microeconomic theory suggests that a monopolist (like the cartel) should operate in a region of the demand curve where demand is elastic (i.e. the elasticity is < -1). 

Is this the case for your estimated demand elasticity? `r mcq(c("No", answer = "Yes"))`

`r hide("Answer:")`

Hence we are tesing $H0: \beta(lnprice)=1  vs H1: \beta(lnprice)>-1$; (i.e. a one sided test)

```{r }
```

i.e. even if $\beta(lnprice)$ is smaller than -1 as in our regressions it is possible to estimate a value that is larger than -1. There comes a point when the value is too large, however, which we can figure out by looking at the threshold that would lead to a stage 1 error of 5%

t-stat=(-0.8666+1)/0.131= 1.0204783

For critical value:

```{r }
qnorm(0.95)
``` 

Hence, we do not reject the null hypothesis; i.e. we cannot conclude that basic mircoeconomics is violated here.


`r unhide()`



