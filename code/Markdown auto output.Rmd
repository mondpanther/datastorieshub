---
title: "Auto"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

## Auto quiz markdown

Remember to install the packages you need at every step. Please note the additional code you need to use in Markdown to specify the default CRAN mirror (repository where packages are kept). You do not need this additional code when using interactive R studio, only when you "knit" your markdown.

This is a markdown with solutions to the R workshop quiz.

# Question 1: Loading data

```{r}

install.packages("haven",repos = "http://cran.us.r-project.org")
library(haven)

auto=read_dta("https://www.dropbox.com/sh/rqmo1hvij1veff0/AACNkMy47ilXAMh3nmiIs_Bqa/auto.dta?dl=1")
```

# Question 2: Mean price of foreign/domestic cars


```{r}

install.packages("dplyr",repos = "http://cran.us.r-project.org")
library(dplyr)

table1=auto %>% group_by(foreign) %>% summarise(mean_price=mean(price))
knitr::kable(table1)
```

# Question 3: Filtering cars cheaper that $5000

```{r}
table2=auto %>% filter(price<5000)
knitr::kable(table2)
```

# Question 4: Add a new var (price/headroom ratio)

```{r}
auto=auto%>%mutate(price_headroom_ratio=price/headroom)
```

# Question 5: Boxplot

```{r}
install.packages("ggplot2",repos = "http://cran.us.r-project.org")
library(ggplot2)

ggplot(auto, aes(x=foreign, y=mpg, group=foreign)) + geom_boxplot()

```

# Question 6: Scatter plot with a regression line

```{r}
ggplot(auto, aes(x=mpg, y=price)) + geom_point() + geom_smooth(method=lm, se=FALSE, color="orange")

```

# Question 7: Regression

```{r}
mod1 <- lm(price~gear_ratio,auto) 
summary(mod1)

```

There is a negative relationship between price and gear ratio. For every one 1 unit increase in gear ratio, the price goes down by 2027.5 USD (assuming the prices are in USD).

# Question 8: Coefficient significance

Looking once again at the regression output we see that the P-value is 0.0065 meaning that the coefficient is significant at the 1% level.

# Question 9: Predicted price

```{r}
mod1$coefficients[[1]]+mod1$coefficients[[2]]*3

```
# Question 10: Range

The range is 2.19 to 3.89.

```{r}

summary(auto$gear_ratio)

```



Note that the `echo = FALSE` parameter can be added to the code chunk to prevent printing of the R code that generated the plot.
