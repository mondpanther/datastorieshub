"0","competition_1 <- function("
"0","  submissions,"
"0","  seed = 100,          # seed for random generation (default = 100)"
"0","  test = FALSE"
"0","  "
"0","  "
"0","  "
"0","  library('e1071')"
"0","  library(caret)"
"0","  "
"0","  "
"0","  # set the seed"
"0","  set.seed(seed)"
"0","  "
"0","  wide_narrow=read_csv(""https://www.dropbox.com/s/asnc2hgczz89p54/wide_narrow.csv?dl=1"")"
"0",""
"0","  #wide_narrow=read_csv(""wide_narrow.csv"")"
"0","  crime=wide_narrow"
"0","  "
"0","  "
"0","  #crime <- read.csv(""https://www.dropbox.com/s/jbpjrrnqligl8a1/crime_competition.csv?dl=1"")"
"0","  val=read.csv(""https://www.dropbox.com/s/06uht448xt0pyh1/wide_narrow_vali.csv?dl=1"")"
"0","  #val <- read.csv(""https://www.dropbox.com/s/lco9i8k0xnlqwqi/crime_validation.csv?dl=1"")"
"0","  "
"0","  crime$avaxhoaxid <- factor(crime$avaxhoaxid,levels = c(FALSE,TRUE), labels = c(""0"",""1""))"
"0","  val$avaxhoaxid <- factor(val$avaxhoaxid,levels = c(FALSE,TRUE), labels = c(""0"",""1""))"
"0","  "
"0","  performance <- data.frame(group = rep(NA, ngroups),"
"0","                            course= rep(NA,ngroups),"
"0","                            #p1 = rep(NA, ngroups),"
"0","                            #r1 = rep(NA, ngroups),"
"0","                            #p2 = rep(NA, ngroups),"
"0","                            formula = rep(NA, ngroups))"
"0","  "
"0","  for(i in 1:ngroups){"
"0","    #source(paste0(""template_1_"",LETTERS[i],"".R""))"
"0","    #formula=submissions[i,""formula""][[1]]"
"0","    groupname=submissions[i,""Name""][[1]]"
"0","    "
"0","    "
"0","    if(test==TRUE){"
"0","    }"
"0","    "
"0","    performance$formula[i] <- formula"
"0","    "
"0","    #e <- function() ""error"""
"0","    result = tryCatch({"
"0","                     family = binomial(logit)) "
"0","      "
"0","      }, "
"0","      error = function(e) {"
"0","      })"
"0","     result    "
"0","       performance$a1[i] <- ""Error"" "
"0","       next"
"0","     }"
"0","     "
"0","    fitted.results <- predict(logit.mod, newdata=crime, type=""response"") # predict probabilities"
"0","    fitted.results <- factor(fitted.results,levels = c(FALSE,TRUE), labels = c(""0"",""1""))"
"0","    performance1 <- confusionMatrix(fitted.results,"
"0","                                    crime[,""avaxhoaxid""])"
"0","    "
"0","    "
"0","    result = tryCatch({"
"0","      fitted.results <- predict(logit.mod, newdata=val, type=""response"") # predict probabilities"
"0","      "
"0","      }, "
"0","      error = function(e) {"
"0","      })"
"0","     result    "
"0","       performance$a1[i] <- ""Error"" "
"0","     }"
"0","    "
"0","    "
"0","    fitted.results <- ifelse(fitted.results > 0.5,1,0) # convert to binary"
"0","    fitted.results <- factor(fitted.results,levels = c(0,1), labels = c(""0"",""1""))"
"0","    performance2 <- confusionMatrix(fitted.results,"
"0","                                    val[,""avaxhoaxid""])"
"0","    "
"0","    performance$a1[i] <- round(performance1$overall[1],4)"
"0","    #performance$p1[i] <- round(performance1$byClass[4],4)"
"0","    #performance$p2[i] <- round(performance2$byClass[4],4)"
"0","    #performance$r2[i] <- round(performance2$byClass[2],4)"
"0","    performance$p[i] <- length(logit.mod$coefficients) - 1"
"0","   "
"0","  "
"0","  colnames(performance) <- c(""Name"", ""Course"","
"0","                             #""precision in train"","
"0","                             #""recall in train"","
"0","                             #""precision in test"","
"0","                             #""recall in test"","
"0","                             ""complexity"","
"0","  "
"0","  #write.csv(performance,""performance_1.csv"")"
"0","  return(performance) "
"0","}"
"0",""
"0",""
"0",""
"0",""
